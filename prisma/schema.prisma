generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Pokemon {
  id               Int              @id
  name             String
  sprite           String
  generation       Int
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt
  baseExperience   Int?
  baseHappiness    Int?
  captureRate      Int?
  color            String?
  evolutionChainId Int?
  evolvesFromId    Int?
  genderRateFemale Float?
  genus            String?
  growthRate       String?
  habitat          String?
  hatchCounter     Int?
  height           Int?
  isBaby           Boolean          @default(false)
  isLegendary      Boolean          @default(false)
  isMythical       Boolean          @default(false)
  shape            String?
  spriteArtwork    String?
  spriteBack       String?
  spriteBackShiny  String?
  spriteHome       String?
  spriteShiny      String?
  weight           Int?
  encounters       Encounter[]
  pokedexEntries   PokedexEntry[]
  abilities        PokemonAbility[]
  moves            PokemonMove[]
  stats            Stat[]
  eggGroups        EggGroup[]       @relation("EggGroupToPokemon")
  types            Type[]           @relation("PokemonToType")
}

model Type {
  id               Int       @id @default(autoincrement())
  name             String    @unique
  doubleDamageFrom String[]
  doubleDamageTo   String[]
  halfDamageFrom   String[]
  halfDamageTo     String[]
  noDamageFrom     String[]
  noDamageTo       String[]
  moves            Move[]
  pokemon          Pokemon[] @relation("PokemonToType")
}

model Stat {
  id        Int     @id @default(autoincrement())
  name      String
  value     Int
  pokemonId Int
  effort    Int     @default(0)
  pokemon   Pokemon @relation(fields: [pokemonId], references: [id], onDelete: Cascade)
}

model Ability {
  id          Int              @id @default(autoincrement())
  name        String           @unique
  effect      String?
  shortEffect String?
  pokemon     PokemonAbility[]
}

model PokemonAbility {
  id        Int     @id @default(autoincrement())
  pokemonId Int
  abilityId Int
  isHidden  Boolean @default(false)
  slot      Int
  ability   Ability @relation(fields: [abilityId], references: [id], onDelete: Cascade)
  pokemon   Pokemon @relation(fields: [pokemonId], references: [id], onDelete: Cascade)

  @@unique([pokemonId, abilityId])
}

model PokedexEntry {
  id          Int     @id @default(autoincrement())
  version     String
  description String
  pokemonId   Int
  pokemon     Pokemon @relation(fields: [pokemonId], references: [id], onDelete: Cascade)
}

model EggGroup {
  id      Int       @id @default(autoincrement())
  name    String    @unique
  pokemon Pokemon[] @relation("EggGroupToPokemon")
}

model Move {
  id          Int           @id @default(autoincrement())
  name        String        @unique
  typeId      Int?
  power       Int?
  accuracy    Int?
  pp          Int?
  priority    Int           @default(0)
  damageClass String?
  effect      String?
  shortEffect String?
  target      String?
  type        Type?         @relation(fields: [typeId], references: [id])
  pokemon     PokemonMove[]
}

model PokemonMove {
  id           Int     @id @default(autoincrement())
  pokemonId    Int
  moveId       Int
  learnMethod  String
  levelLearned Int?
  versionGroup String?
  move         Move    @relation(fields: [moveId], references: [id], onDelete: Cascade)
  pokemon      Pokemon @relation(fields: [pokemonId], references: [id], onDelete: Cascade)

  @@unique([pokemonId, moveId, learnMethod, versionGroup])
}

model EvolutionChain {
  id    Int  @id
  chain Json
}

model Encounter {
  id           Int     @id @default(autoincrement())
  pokemonId    Int
  locationName String
  versionName  String
  method       String
  minLevel     Int?
  maxLevel     Int?
  chance       Int?
  pokemon      Pokemon @relation(fields: [pokemonId], references: [id], onDelete: Cascade)
}
